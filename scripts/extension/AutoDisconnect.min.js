var threshold=8,delay=1e3;function sleep(a){return new Promise(b=>setTimeout(b,a))}var dotask=!0;async function action(){for(dotask=!0,console.clear();dotask;){var a=0,b=document.getElementById("roster-button");"15"==b.getAttribute("track-outcome")&&b.click();for(var c=document.getElementsByTagName("calling-roster-section"),d=0;d<c.length;d++)if("ctrl.participantsInCall"==c[d].getAttribute("participants-list")||"ctrl.attendeesInMeeting"==c[d].getAttribute("participants-list"))for(var e=c[d].children[0].children[0].getElementsByTagName("button"),f=0;f<e.length;f++)e[f].classList.contains("roster-list-title")&&(a+=parseInt(e[f].children[2].innerHTML.replace("(","").replace(")","")));console.log("Users in meeting: "+a+"\nDownload this script: https://github.com/dikahdoff/TeamsUtils"),a<=threshold&&0!=a&&(document.getElementById("hangup-button").click(),dotask=!1,console.warn("Threshold is 8, disconnecting at "+a+" attendees...\nDownload this script: https://github.com/dikahdoff/TeamsUtils")),await sleep(delay)}}async function cancelAction(){dotask=!1}action();