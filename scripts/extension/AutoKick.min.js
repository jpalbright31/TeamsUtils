var kickDelay=150,targetName="John Smith";function sleep(a){return new Promise(b=>setTimeout(b,a))}var dokicking=!0;async function kickingAction(){for(dokicking=!0,console.clear();dokicking;){try{var a=document.getElementById("roster-button");"15"==a.getAttribute("track-outcome")&&a.click()}catch(a){}for(var b=document.getElementsByTagName("calling-roster-section"),c=0;c<b.length;c++)if("ctrl.participantsFromMeeting"!=b[c].getAttribute("participants-list")&&"ctrl.participantsFromTeamSuggestions"!=b[c].getAttribute("participants-list"))for(var d=b[c].children[0].children[1].children[0].children[0].children,e=0;e<d.length;e++)if("listitem"==d[e].getAttribute("role"))for(var f=d[e].children,g=0;g<f.length;g++)if(f[g].classList.contains("participantInfo")){for(var h=f[g].children,p=!0,q=0;q<h.length;q++)h[q].classList.contains("organizerStatus")&&(p=!1);for(var r=0;r<f.length;r++)if(f[r].classList.contains("stateActions"))for(var s=f[r].children,t=0;t<s.length;t++)s[t].classList.contains("state")&&""!=s[t].innerHTML&&(p=!1);if(p)for(var q=0;q<h.length;q++)if(h[q].classList.contains("name")){var u=h[q].children[0].innerHTML;if(u.toLowerCase().contains(targetName.toLowerCase())){console.log("Found "+targetName+" as "+u+", kicking...\nDownload this script: https://github.com/dikahdoff/TeamsUtils");for(var v=0;v<f.length;v++)if(f[v].classList.contains("stateActions")&&f[v].classList.contains("hide-participant-state"))for(var w=f[v].children,z=0;z<w.length;z++)if(w[z].classList.contains("participant-menu")&&"ctrl.actionsMenuEnabled"==w[z].getAttribute("ng-if")){w[z].children[0].children[0].click(),await sleep(5);var A=document.getElementsByClassName("context-dropdown");if(0<A.length)for(var B=A[0].children[0].children,C=0;C<B.length;C++)"calling_roster_remove_paticipant_popup_item"==B[C].children[0].children[1].getAttribute("translate-once")&&(B[C].children[0].click(),console.log(u+" has been kicked...\nDownload this script: https://github.com/dikahdoff/TeamsUtils"));else console.log("Please wait...\nDownload this script: https://github.com/dikahdoff/TeamsUtils")}}}}await sleep(kickDelay)}}async function cancelKicking(){dokicking=!1}kickingAction();