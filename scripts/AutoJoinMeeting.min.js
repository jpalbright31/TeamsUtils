var joinDelay=1e3,joinWait=5e3,switchChannel=!1,switchTo="TeamName",switchToChannel="ChannelName";function sleep(a){return new Promise(b=>setTimeout(b,a))}var dojoining=!0,didswitch=!1;async function joiningAction(){for(dojoining=!0,console.clear();dojoining;){if(switchChannel&&!didswitch){console.warn("Switching to "+switchTo+" before fetching...\nDownload this script: https://github.com/dikahdoff/TeamsUtils");var a=document.getElementsByClassName("app-left-rail-width");if(!(0<a.length))console.error("Couldn't find teams list.\nDownload this script: https://github.com/dikahdoff/TeamsUtils");else if(a=a[0].children[0].children[0].children[1].children,0<a.length){for(var b=0;b<a.length;b++)if(a[b].classList.contains("team")){var c=a[b].children[0].children[0].children[0].children[1].children[0].children[0].innerHTML;if(c.toLowerCase().contains(switchTo.toLowerCase())){console.log("Found "+switchTo+" team, opening if necessary...\nDownload this script: https://github.com/dikahdoff/TeamsUtils"),"false"==a[b].getAttribute("aria-expanded")&&(console.log(a[b]),a[b].children[0].children[0].click()),await sleep(50);for(var d,e=a[b].children[0].children[1].children[0].children[0].children,f=0;f<e.length;f++)d=e[f].children[0].children[0].children[0].innerHTML,d.toLowerCase().contains(switchToChannel.toLowerCase())&&(console.log("Found "+switchToChannel+" channel, opening if necessary...\nDownload this script: https://github.com/dikahdoff/TeamsUtils"),e[f].children[0].click(),didswitch=!0)}}}else console.error("You don't have any teams to join to.\nDownload this script: https://github.com/dikahdoff/TeamsUtils");await sleep(joinDelay)}console.log("Fetching meetings...\nDownload this script: https://github.com/dikahdoff/TeamsUtils");var g=document.getElementsByClassName("ts-sym ts-btn ts-btn-primary inset-border icons-call-jump-in ts-calling-join-button app-title-bar-button app-icons-fill-hover call-jump-in");if(0<g.length){g=g[0],console.log("Found a meeting, joining in "+joinWait+"ms\nDownload this script: https://github.com/dikahdoff/TeamsUtils"),await sleep(joinWait),console.log("Joining...\nDownload this script: https://github.com/dikahdoff/TeamsUtils"),g.click(),await sleep(100);var h=document.getElementsByClassName("ts-btn ts-btn-fluent ts-btn-fluent-secondary-alternate");0<h.length&&(h[0].click(),console.warn("Closed warning box.\nDownload this script: https://github.com/dikahdoff/TeamsUtils")),await sleep(100);var k=document.getElementById("preJoinAudioButton");null!=k&&"30"==k.getAttribute("telemetry-outcome")&&(k.children[0].children[0].click(),console.warn("Turned microphone off.\nDownload this script: https://github.com/dikahdoff/TeamsUtils")),await sleep(50);for(var l=document.getElementsByTagName("toggle-button"),b=0;b<l.length;b++)if("ctrl.toggleVideo()"==l[b].getAttribute("on-click")){var m=l[b];0<m.length&&"26"==m.getAttribute("telemetry-outcome")&&(m.children[0].children[0].click(),console.warn("Turned camera off.\nDownload this script: https://github.com/dikahdoff/TeamsUtils"))}await sleep(50);var n=document.getElementsByClassName("join-btn ts-btn inset-border ts-btn-primary");0<n.length?(n[0].click(),dojoining=!1,console.log("Joined.\nDownload this script: https://github.com/dikahdoff/TeamsUtils")):console.error("Failed to join meeting, can't find the join button.\nDownload this script: https://github.com/dikahdoff/TeamsUtils")}await sleep(joinDelay)}}async function cancelJoining(){dojoining=!1}joiningAction();